<!DOCTYPE html>
<html lang="en">

<head>
    <%- include('partials/indexHead') %>
        <style>
            .imagenCarrito {
                width: 120px;
                height: 120px;
            }
        </style>
</head>

<body>
    <header>
        <%- include('partials/indexHeader') %>
    </header>
    <main>
        <section class="d-flex flex-wrap">
            <% productos.forEach(producto=> { %>
                <div class="card m-3" style="width: 18rem;">
                    <img src="<%= producto.imagen %>" class="card-img-top object-fit-contain">
                    <div class="card-body d-flex justify-content-between">
                        <div class="d-flex flex-column justify-content-center">
                            <p class="card-text text-success fw-bold">$<%= producto.precio %></p>
                            <p class="card-title"><%= producto.nombre %></p>
                        </div>
                        <!-- <form action="addtocart" method="post" class="d-flex align-items-center">
                            <input type="hidden" value="<%= producto._id %>" name="idCart">
                            <button class="btn btn-dark" type="submit"><i class="bi bi-cart"></i></button>
                        </form> -->
                        <div class="d-flex align-items-center">
                            <button class="btn btn-dark" type="submit" onclick="agregarAlCarrito(`<%=producto %>`)"><i class="bi bi-cart"></i></button>
                        </div>
                    </div>
                </div>
                <% });%>
        </section>
    </main>
</body>
<%- include('partials/indexModals') %>
    <script>
        function carrito(nombre, imagen) {
            const cart = document.getElementById('offcanvasBody');
            let item = document.createElement('div')
            let nombreProducto = document.createElement('p')
            nombreProducto.textContent = nombre
            let imagenProducto = document.createElement('img')
            imagenProducto.classList.add('imagenCarrito')
            imagenProducto.src = imagen

            item.appendChild(nombreProducto)
            item.appendChild(imagenProducto)
            nombre

            cart.appendChild(item);
        }

        function agregarAlCarrito(producto) {
            //en la cookie se guarda un arreglo con los productos del carrito
            //leo la cookie del carrito a ver si ya hay algo
            //si hay algo, adiciono el ultimo producto seleccionado
            //guardo de nuevo el arreglo como cookie que ya est√° actualizado
            cartCookies = sessionStorage.getItem('producto');
            if (cartCookies == 'null' || cartCookies == null){
                alert("No hay carrito")
                sessionStorage.setItem('producto', producto)
            } else {
                alert (`${producto} ya esta en el carrito`)
                sessionStorage.setItem('producto', producto)
            }
        }
    </script>

</html>